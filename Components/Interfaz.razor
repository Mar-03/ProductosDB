@page "/"

@rendermode InteractiveServer

<div class="pedido-container">

    <div class="header">
        <h1>NUEVO PEDIDO</h1>
        <p>Complete todos los campos requeridos para procesar su transacción de forma segura.</p>
    </div>

    <div class="layout">

        <!-- COLUMNA IZQUIERDA -->
        <div class="col-left">

            <!-- DATOS CLIENTE -->
            <div class="card card-wide">
                <h2><i class="bi bi-person icon"></i> DATOS CLIENTE</h2>

                <div class="grid-2">
                    <div>
                        <label>NIT</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Nombre Completo</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Teléfono</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Correo Electrónico</label>
                        <input type="email" />
                    </div>
                </div>
            </div>

            <!-- DETALLE PRODUCTO -->
            <div class="card card-wide">
                <h2><i class="bi bi-box-seam icon"></i> DETALLE PRODUCTO</h2>

                <div class="grid-3">
                    <div>
                        <label>Producto</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Cantidad</label>
                        <input type="number" min="0" />
                    </div>

                    <div>
                        <label>Tipo de Pedido</label>
                        <input type="text" />
                    </div>
                </div>
            </div>

            <!-- INFORMACIÓN DE ENVÍO -->
            <div class="card card-wide">
                <h2><i class="bi bi-truck icon"></i> INFORMACIÓN DE ENVÍO</h2>

                <div class="grid-2">
                    <div>
                        <label>Método de Entrega</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Ciudad/Municipio</label>
                        <input type="text" />
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <label>Dirección de Entrega</label>
                        <input type="text" />
                    </div>

                    <div>
                        <label>Referencia</label>
                        <input type="text" />
                    </div>
                </div>
                <div>
                    <button class="btn-primary" @onclick="ConfirmarDatos"> Confirmar Datos</button>
                </div>
            </div>

        </div>

        <!-- COLUMNA DERECHA -->
        <div class="col-right">

            <!-- MÉTODO DE PAGO -->
            <div class="card card-narrow">
                <h2><i class="bi bi-credit-card icon"></i> MÉTODO DE PAGO</h2>
                <label>Tipo de Pago</label>
                <select id="filter-payment" @bind="TipoPagoSeleccionado">
                    <option value="">Seleccione</option>
                    <option value="efectivo">Efectivo</option>
                    <option value="tarjeta">Pago con Tarjeta</option>
                    <option value="transferencia">Transferencia</option>
                </select>

                @if (TipoPagoSeleccionado == "tarjeta")
                {
                    <div class="mt-3">
                        <label>Número de Tarjeta</label>
                        <input type="text" @bind="NumeroTarjeta" placeholder="Ingrese número de tarjeta" />

                        @if (MostrarErrores && string.IsNullOrWhiteSpace(NumeroTarjeta))
                        {
                            <small style="color:red">Debe ingresar número de tarjeta</small>
                        }
                    </div>
                }

                @if (TipoPagoSeleccionado == "transferencia")
                {
                    <div class="mt-3">
                        <label>Número de Transferencia</label>
                        <input type="text" @bind="NumeroTransferencia" placeholder="Ingrese número de transferencia" />

                        @if (MostrarErrores && string.IsNullOrWhiteSpace(NumeroTransferencia))
                        {
                            <small style="color:red">Debe ingresar número de transferencia</small>
                        }
                    </div>
                }
                <div class="info-box mt-3">
                    <i class="bi bi-info-circle-fill info-icon"></i>
                    <span>Sus datos están protegidos con encriptación de grado bancario.</span>
                </div>

            </div>

            <!-- RESUMEN DE ORDEN -->
            <div class="card card-narrow">
                <h2><i class="bi bi-receipt icon"></i> RESUMEN DE ORDEN</h2>

                <div class="summary-row">
                    <span>Subtotal</span>
                    <input type="text" readonly />
                </div>

                <div class="summary-row">
                    <span>Envío</span>
                    <input type="text" readonly />
                </div>

                <div class="summary-row">
                    <span>Impuestos (IVA)</span>
                    <input type="text" readonly />
                </div>

                <div class="summary-row total">
                    <span>TOTAL</span>
                    <input type="text" readonly />
                </div>


                @if (MostrarBotonTransaccion)
                {
                    <button class="btn-primary" @onclick="RealizarTransaccion">
                        Realizar Transacción
                    </button>
                }

            </div>

        </div>

    </div>

</div>

@code {
    string TipoPagoSeleccionado = "";
    string NumeroTarjeta = "";
    string NumeroTransferencia = "";

    bool MostrarErrores = false;

    bool MostrarBotonTransaccion = false;


    void ConfirmarDatos()
    {
        MostrarBotonTransaccion = true;
    }


    void RealizarTransaccion()
    {
        MostrarErrores = true;

        if (string.IsNullOrWhiteSpace(TipoPagoSeleccionado))
            return;

        if (TipoPagoSeleccionado == "tarjeta" &&
            string.IsNullOrWhiteSpace(NumeroTarjeta))
            return;

        if (TipoPagoSeleccionado == "transferencia" &&
            string.IsNullOrWhiteSpace(NumeroTransferencia))
            return;

        // Si pasa validación
        Console.WriteLine("Transacción válida");
    }
}